# Replication

### Sync Replication vs Async Replication
- Replication can be done synchronously or asynchronously
- Semi-synchronous: If the DB is configurated for synchronous replication, it means one slave is synchronous with master. Other slaves are asynchronous with master

![replication-1](https://ddia.pigsty.io/img/fig5-2.png)
- Slave 1 is synchronous with master
- Slave 2 is asynchronous with master

Synchronous Replication
- Advantages:
    - Data consistency is guaranteed. If master fails, we can make sure the data is stored in slave
- Disadvantages:
    - If the asynchronous slave has no response, the master will not be able to write data

### Setup New Replica
1. Take a snapshot of the primary database (master)
2. Copy the snapshot to the new replica node
3. The replica connects to the master and fetches all data changes that occurred after the snapshot. This requires the snapshot to be precisely associated with a position in the master's replication log. This position has different names, such as PostgreSQL’s log sequence number (LSN) or MySQL’s binlog coordinates.
4. Once the replica processes the backlog of data changes accumulated after the snapshot, it is said to have caught up with the master. It can then continue processing data changes produced by the primary in real-time.